module Geom
import Enum

let Pt = (Enum.record :x :y)
let Line = (Enum.record :a :b)

def (dist p1 p2) do
  let dx = (p1 :x) - (p2 :x),
      dy = (p1 :y) - (p2 :y)
  Math.sqrt (dx * dx) + (dy * dy)
end

def (midpoint p1 p2) do
  let x = ((p1 :x) + (p2 :x)) / 2,
      y = ((p1 :y) + (p2 :y)) / 2
  Pt x y
end

def (random_pt) do
  let x = Math.rand_int (Canvas.width),
      y = Math.rand_int (Canvas.height)
  Pt x y
end
