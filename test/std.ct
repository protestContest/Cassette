module Std

def (range min max) do
  def (loop n list) do
    if n < min do
      list
    else
      loop n - 1 n | list
    end
  end

  loop max - 1 nil
end

def (reduce list acc fn) do
  if list == nil do
    acc
  else
    reduce (tail list) (fn (head list) acc) fn
  end
end

def (reverse list) do
  reduce list nil (item reversed) -> item | reversed
end

def (map list fn) do
  reverse (reduce list nil (item acc) -> (fn item) | acc)
end

def (filter list fn) do
  reverse (reduce list nil (item acc) -> do
      if (fn item) do
        item | acc
      else
        acc
      end
    end)
end
