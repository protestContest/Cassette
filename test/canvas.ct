module Canvas
export new, clear, present, line

def new(width, height) do
  let canvas = sdl_new_window(width, height)
  clear(canvas)
  sdl_present(canvas)
end

def clear(canvas) do
  sdl_set_color(255, 255, 255, canvas)
  sdl_clear(canvas)
  sdl_set_color(0, 0, 0, canvas)
end

def present(canvas) do
  def loop() do
    let event = sdl_poll_event()

    if event do
      cond
        event[0] == :keydown and event[2] == :escape -> nil
        event[0] == :quit -> nil
        true -> loop()
      end
    else
      loop()
    end
  end
  loop()
  sdl_destroy_window(canvas)
end

def line(x1, y1, x2, y2, canvas) sdl_line(10, 10, 100, 100, canvas)
